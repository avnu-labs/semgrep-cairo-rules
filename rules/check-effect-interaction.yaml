rules:
  - id: broken-check-effect-interaction
    message: |
      unused argument '$ARG' found in function '$F'
    severity: WARNING
    mode: join
    join:
      rules:
        - id: contract-interface-declaration
          languages: [cairo]
          patterns:
            - pattern: |
                #[starknet::interface]
                trait $CONTRACT_INTERFACE { 
                  ...
                  fn $F(...);
                  ...
                }
        - id: check-effect-interaction
          languages: [cairo]
          patterns:
            - pattern-inside: |
                #[contract]
                mod $CONTRACT {
                  ...
                  struct Storage {
                    ...,
                    $FIELD: $TYPE,
                    ...
                  }
                  ...
                }
            - pattern: |
                fn $G(...) {
                  ...
                  ... . $F(...);
                  ...
                  $FIELD::write(...);
                  ...
                }
      on:
        - 'contract-interface-declaration.$F == check-effect-interaction.$F'
